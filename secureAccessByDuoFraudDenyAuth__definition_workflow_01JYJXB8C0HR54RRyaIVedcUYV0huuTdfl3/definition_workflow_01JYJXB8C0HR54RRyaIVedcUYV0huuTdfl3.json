{
  "workflow": {
    "unique_name": "definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3",
    "name": "Secure Access by Duo - Fraud / Deny auth",
    "title": "Secure Access by Duo - Fraud / Deny auth",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 3720,
          "scope": "local",
          "name": "interval",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01JZJKVMAZYF24229wkg1zmzRqmTcXfmHRt",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "observables",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01M1FRV0UGSQC0afOGQfU0L2tmgJ2Df4jFW",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "This Workflow will fetch DENIED and FRAUD Auth logs from Duo and create a Casebook / Sigthings in SecureX.\n\nThis workflow look for email (fraud alert) in IMAP to be trigger. \n\nRun every hour to get the denied auth.",
      "display_name": "Secure Access by Duo - Fraud / Deny auth",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint",
            "email.smtp_endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eq",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "Duo"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01LWCXWHCTNL71rTdf8EdIdWQ8xahbPvu2v",
        "name": "Sleep",
        "title": "Sleep",
        "type": "core.sleep",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "description": "Duo logs are available in the Duo admin logs with a 2 minutes delay.",
          "display_name": "Sleep",
          "skip_execution": false,
          "sleep_interval": 120
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01M1FYEEHIAI01TypPXCCI6h72IO4MVCQS7",
        "name": "Parallel Block",
        "title": "Parallel Block",
        "type": "logic.parallel",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Parallel Block",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01M1FYF9N1IHO4cpDhu9vfZBM44FgmrwcYM",
            "name": "Parallel Branch",
            "title": "Parallel Branch",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "display_name": "Parallel Branch"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01JYQ3CR65QBD5tWih2BMCPXnrFWfcCxtlz",
                "name": "Duo Admin - Get DENIED or FRAUD Auth Logs",
                "title": "Duo Admin - Get DENIED or FRAUD Auth Logs",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Duo Admin - Get DENIED or FRAUD Auth Logs",
                  "input": {
                    "variable_workflow_01JYONCDL0ADB4IZLAcSVmveFdgbtqCxHrr": "$global.variable_01JBFMBVN62Y67X2aODY3UyX2L0ZC1inw0Y.global.variable_01JBFMBVN62Y67X2aODY3UyX2L0ZC1inw0Y$",
                    "variable_workflow_01JYONCDL0BHW58WNDfZAHRUxhWxd3GFbUH": "$global.variable_01J3NMTLR7YNW6Mhw1jTeohcSLMbVqTHWbQ.global.variable_01J3NMTLR7YNW6Mhw1jTeohcSLMbVqTHWbQ$",
                    "variable_workflow_01JYONCDL0CLA7V3TBrkPc7OVTkMcJ3l2u4": "$global.variable_01JBFLXC643HF1ugwbVoGAFGk9Co2XntKOE.global.variable_01JBFLXC643HF1ugwbVoGAFGk9Co2XntKOE$",
                    "variable_workflow_01JYONCDL0H167XHYbhT21jIScYmW8x6pL1": "$workflow.definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3.local.variable_workflow_01JZJKVMAZYF24229wkg1zmzRqmTcXfmHRt$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eq",
                            "right_operand": "Duo"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01JYONCDVQVZ62K7SkNWdQCuAPUgfdRcFAF"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01JZ9SZGWG2A457iHAX9T5xJkdL6z5UgJMh",
                "name": "Read Table from JSON",
                "title": "Read  authlogs JSON",
                "type": "corejava.read_table_from_json",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Read  authlogs JSON",
                  "input_json": "$activity.definition_activity_01JYQ3CR65QBD5tWih2BMCPXnrFWfcCxtlz.output.variable_workflow_01JYONCDL03781exkHN1ukWFS4YmGF7OkuS$",
                  "jsonpath_query": "$.response.authlogs",
                  "persist_output": false,
                  "populate_columns": false,
                  "skip_execution": false,
                  "table_columns": [
                    {
                      "column_name": "access_device",
                      "column_type": "string"
                    },
                    {
                      "column_name": "alias",
                      "column_type": "string"
                    },
                    {
                      "column_name": "application",
                      "column_type": "string"
                    },
                    {
                      "column_name": "auth_device",
                      "column_type": "string"
                    },
                    {
                      "column_name": "email",
                      "column_type": "string"
                    },
                    {
                      "column_name": "event_type",
                      "column_type": "string"
                    },
                    {
                      "column_name": "factor",
                      "column_type": "string"
                    },
                    {
                      "column_name": "isotimestamp",
                      "column_type": "string"
                    },
                    {
                      "column_name": "odd_software",
                      "column_type": "string"
                    },
                    {
                      "column_name": "reason",
                      "column_type": "string"
                    },
                    {
                      "column_name": "result",
                      "column_type": "string"
                    },
                    {
                      "column_name": "timestamp",
                      "column_type": "integer"
                    },
                    {
                      "column_name": "trusted_endpoint_status",
                      "column_type": "string"
                    },
                    {
                      "column_name": "txid",
                      "column_type": "string"
                    },
                    {
                      "column_name": "user",
                      "column_type": "string"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01M1FYFAPDQ434hywX0B2WesZJdLKO4FgSV",
            "name": "Parallel Branch",
            "title": "Parallel Branch",
            "type": "logic.parallel_block",
            "base_type": "activity",
            "properties": {
              "display_name": "Parallel Branch"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01LW7XBX9TJE70eyZyhPZjz6QEGh8MzkYEv",
                "name": "Threat Response v2 - Generate Access Token",
                "title": "Threat Response v2 - Generate Access Token",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threat Response v2 - Generate Access Token",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eq",
                            "right_operand": "CTR_For_Access_Token"
                          }
                        ]
                      }
                    }
                  },
                  "workflow_id": "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss"
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh",
        "name": "For Each",
        "title": "For Each",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "For Each",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01JZ9SZGWG2A457iHAX9T5xJkdL6z5UgJMh.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01ML0HHZE59036wCbarSlXqAZT8jxw9GjaH",
            "name": "Select from Table",
            "title": "Select from Table",
            "type": "core.selectfromtable",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "columns": [
                {
                  "column_name": "timestamp",
                  "column_type": "integer"
                }
              ],
              "continue_on_failure": false,
              "display_name": "Select from Table",
              "input_table": "$env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3.env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3$",
              "number_of_rows": {
                "all_rows": true
              },
              "persist_output": false,
              "skip_execution": false,
              "sorting": {
                "no_sort": true,
                "sort_by": false
              },
              "where_clause": "txid == '$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].txid$'"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MKZ4F5G2BY83KTTigF3O8qcgJXzgmeM99",
            "name": "Condition Block",
            "title": "Condition Block",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Condition Block",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01MKZ4G1QG2F45M9bqNPeofpzyYq0Fk1Rnf",
                "name": "Condition Branch",
                "title": "yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01ML0HHZE59036wCbarSlXqAZT8jxw9GjaH.output.row_count$",
                    "operator": "ne",
                    "right_operand": 0
                  },
                  "continue_on_failure": false,
                  "display_name": "yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01MKZ4G2BG2BU7XYfFteZwNqODPGJk5ab8q",
                "name": "Condition Branch",
                "title": "no",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01ML0HHZE59036wCbarSlXqAZT8jxw9GjaH.output.row_count$",
                    "operator": "eq",
                    "right_operand": 0
                  },
                  "continue_on_failure": false,
                  "display_name": "no",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MKZ7GMHWHXR32l4f7C2WqDLuMR4gCY0mf",
                    "name": "Add Row to Table",
                    "title": "Add Row to Table",
                    "type": "core.addrowtotable",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Add Row to Table",
                      "input_table": "$env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3.env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3$",
                      "row": [
                        {
                          "key": "txid",
                          "type": "string",
                          "value": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].txid$"
                        },
                        {
                          "key": "timestamp",
                          "type": "integer",
                          "value": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].timestamp$"
                        },
                        {
                          "key": "user",
                          "type": "string",
                          "value": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].user$"
                        },
                        {
                          "key": "result",
                          "type": "string",
                          "value": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].result$"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01M1GFZ7GUF6233PLZGMkViaCCeHydxJeiD",
                    "name": "Parallel Block",
                    "title": "Parallel Block",
                    "type": "logic.parallel",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Parallel Block",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01M1GFZSNT5796J23Ch2yaPaHCpEAn1IESX",
                        "name": "Parallel Branch",
                        "title": "Access Device",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Access Device",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs",
                            "name": "JSONPath Query",
                            "title": "JSONPath Query access_device",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "JSONPath Query access_device",
                              "input_json": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].access_device$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "browser",
                                  "jsonpath_query_name": "browser",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "browser_version",
                                  "jsonpath_query_name": "browser_version",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "hostname",
                                  "jsonpath_query_name": "hostname",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "ip",
                                  "jsonpath_query_name": "ip",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.city",
                                  "jsonpath_query_name": "city",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.country",
                                  "jsonpath_query_name": "country",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.state",
                                  "jsonpath_query_name": "state",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M1GFZTUAP4N1g203cwrQmRn4SQJOL5E4x",
                        "name": "Parallel Branch",
                        "title": "Auth Device",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Auth Device",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F",
                            "name": "JSONPath Query",
                            "title": "JSONPath Query auth_device",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "JSONPath Query auth_device",
                              "input_json": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].auth_device$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "ip",
                                  "jsonpath_query_name": "auth_device_ip",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.city",
                                  "jsonpath_query_name": "auth_device_city",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.country",
                                  "jsonpath_query_name": "auth_device_country",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "location.state",
                                  "jsonpath_query_name": "auth_device_state",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "name",
                                  "jsonpath_query_name": "auth_device_name",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M1GGTWQGEZP2Vui1ETPXqfyn21XCkSKvp",
                        "name": "Parallel Branch",
                        "title": "Application",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Application",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01JZGBP9E9BYK6PjVxV46cLInC6VyDhxlAj",
                            "name": "JSONPath Query",
                            "title": "JSONPath Query application",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "JSONPath Query application",
                              "input_json": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].application$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "key",
                                  "jsonpath_query_name": "application_key",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "name",
                                  "jsonpath_query_name": "application_name",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01M1GGZBGXW3B0BK451GDPoyb9TMsFDtdO6",
                        "name": "Parallel Branch",
                        "title": "User",
                        "type": "logic.parallel_block",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "User",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS",
                            "name": "JSONPath Query",
                            "title": "JSONPath Query user",
                            "type": "corejava.jsonpathquery",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "JSONPath Query user",
                              "input_json": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].user$",
                              "jsonpath_queries": [
                                {
                                  "jsonpath_query": "groups",
                                  "jsonpath_query_name": "groups",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "key",
                                  "jsonpath_query_name": "user_key",
                                  "jsonpath_query_type": "string"
                                },
                                {
                                  "jsonpath_query": "name",
                                  "jsonpath_query_name": "username",
                                  "jsonpath_query_type": "string"
                                }
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01M1HDQCIY3N76FvgNTV87ApIZHJzobMH2P",
                    "name": "Group",
                    "title": "Create observables json",
                    "type": "logic.group",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Create observables json",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01M1FR5TX6TNJ2wAGKwhYDYtoVGKOZCvixZ",
                        "name": "Condition Block",
                        "title": "Hostname ?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Hostname ?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01M1FR6FFV0Z23iynTBdMI2PuanKdcDEub7",
                            "name": "Condition Branch",
                            "title": "yes",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.hostname$",
                                  "operator": "ne",
                                  "right_operand": ""
                                },
                                "operator": "and",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.hostname$",
                                  "operator": "ne",
                                  "right_operand": "null"
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "yes",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M1FTXQQ2ZYW3uSUOsxyr0u0Ys0B8J3qCm",
                                "name": "Set Variables",
                                "title": "Set Variables",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variables",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3.local.variable_workflow_01M1FRV0UGSQC0afOGQfU0L2tmgJ2Df4jFW$",
                                      "variable_value_new": "[\n{\n\"type\": \"user\",\n\"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\"\n},\n{\n\"type\": \"ip\",\n\"value\": \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\"\n},\n{\n\"type\":\"hostname\",\n\"value\":\"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.hostname$\"\n}\n]"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01M1FR6GSCC1X68zfzBT0tEZXlTFwNrJTou",
                            "name": "Condition Branch",
                            "title": "no",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": {
                                  "left_operand": "$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.hostname$",
                                  "operator": "eq",
                                  "right_operand": ""
                                },
                                "operator": "or",
                                "right_operand": {
                                  "left_operand": "$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.hostname$",
                                  "operator": "eq",
                                  "right_operand": "null"
                                }
                              },
                              "continue_on_failure": false,
                              "display_name": "no",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01M1FS3533JNG0wADDSCtcmf5ss2ftZVd09",
                                "name": "Set Variables",
                                "title": "Set Variables observables",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Variables observables",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3.local.variable_workflow_01M1FRV0UGSQC0afOGQfU0L2tmgJ2Df4jFW$",
                                      "variable_value_new": "[\n{\n\"type\": \"user\",\n\"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\"\n},\n{\n\"type\": \"ip\",\n\"value\": \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\"\n}\n]"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01LW7YZ7B9XX12FN88b4jZnz5M9biNb6uPR",
                    "name": "Threat Response v2 - Create Casebook",
                    "title": "Threat Response v2 - Create Casebook",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Threat Response v2 - Create Casebook",
                      "input": {
                        "variable_workflow_01KVOGF4J481T6SCd7uh5fW7n47Q712nleJ": "$workflow.definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3.local.variable_workflow_01M1FRV0UGSQC0afOGQfU0L2tmgJ2Df4jFW$",
                        "variable_workflow_01KVOGF4J4FZC0jmaR42b1FbIzVZA19KbYL": "Protected APP : **$activity.definition_activity_01JZGBP9E9BYK6PjVxV46cLInC6VyDhxlAj.output.jsonpath_queries.application_name$**\n- Result: **$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].result$**\n- Reason: **$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].reason$**\n- Access Device location : **$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.city$, $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.state$, $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.country$**\n- Access Device IP: **$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$**\n- Browser : **$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.browser$ , $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.browser_version$**\n- Time : $activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].isotimestamp$\n- User: **$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$**\n- User Group: $activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.groups$\n- Email: $activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].email$\n- Auth Device Name : **$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_name$**\n- Auth Device Location: **$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_city$, $activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_state$, $activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_country$**\n- Auth Device IP: **$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_ip$**",
                        "variable_workflow_01KVOGF4J4IG81TQKFjqzLlnFJwiiNwXwSq": "$activity.definition_activity_01LW7XBX9TJE70eyZyhPZjz6QEGh8MzkYEv.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$",
                        "variable_workflow_01KVOGF4J4JL52xC9ZXdjYwHt2SvRYkArli": "Cisco Duo MFA  - $activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].reason$ user :  $activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$",
                        "variable_workflow_01KVOMXV9ERSV0M9j1WarflgSG8r5SpZ8b5": "",
                        "variable_workflow_01LFBYQJV9FZA2THdEQrMftLyGiiHP65nUq": "amber"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01JZHMN7CWYCV1DRRdIv3n3FvOXgNjD1DAy",
                    "name": "HTTP Request",
                    "title": "Create Sigthings",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "body": "{\n        \"schema_version\": \"1.0.11\",\n        \"observables\": [\n                {\"value\": \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\", \"type\": \"ip\"},\n                {\"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\", \"type\": \"user\"}\n                ],\n        \"type\": \"sighting\",\n        \"title\": \"Cisco Duo Event\",\n        \"count\": 1,\n        \"targets\": [{\n                \"type\": \"user\",\n                \"observables\": [\n                    {\n                        \"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\",\n                        \"type\": \"user\"\n                    }\n                ],\n                \"observed_time\": {\n                    \"start_time\": \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].isotimestamp$\"\n                }\n            } \n        ],\n        \"relations\": [\n            {\n                \"origin\": \"Cisco Duo MFA\",\n                \"relation\": \"Connected_To\",\n                \"source\": {\n                    \"value\": \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\",\n                    \"type\": \"ip\"\n                },\n                \"related\": {\n                    \"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\",\n                    \"type\": \"user\"\n                }\n              },\n             {\n                \"origin\": \"Cisco Duo MFA\",\n                \"relation\": \"Parent_Of\",\n                \"source\": {\n                    \"value\": \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\",\n                    \"type\": \"user\"\n                },\n                \"related\": {\n                    \"value\": \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\",\n                    \"type\": \"ip\"\n                }\n              }\n\n        ],\n        \"tlp\": \"amber\",\n        \"source\": \"Cisco Duo MFA\",\n        \"description\": \"Automated sightings creation from Cisco Duo MFA\",\n        \"timestamp\": \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].isotimestamp$\",\n        \"confidence\": \"High\",\n        \"observed_time\": {\"start_time\": \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].isotimestamp$\",\n                          \"end_time\": \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].isotimestamp$\"\n                          },\n         \"data\": {\n            \"columns\": [\n                {\n                    \"name\": \"User\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Application\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Result\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Reason\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Access Device Location\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Access Device IP\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Browser\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Time\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Email\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Auth Device Name\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Auth Device Location\",\n                    \"type\": \"string\"\n                },\n                {\n                    \"name\": \"Auth Device IP\",\n                    \"type\": \"string\"\n                }            ],\n            \"rows\": [\n                [\n                    \"$activity.definition_activity_01JZGCSO44MLZ5Fjl6r3qk1qIGvuGtm4cJS.output.jsonpath_queries.username$\",\n                    \"$activity.definition_activity_01JZGBP9E9BYK6PjVxV46cLInC6VyDhxlAj.output.jsonpath_queries.application_name$\",\n                    \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].result$\",\n                    \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].reason$\",\n                    \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.city$, $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.state$, $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.country$\",\n                    \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.ip$\",\n                    \"$activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.browser$, $activity.definition_activity_01JZBK19U8D3V0sYgSUjkBITCejlhNQXPVs.output.jsonpath_queries.browser_version$\",\n                    \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].timestamp$\",\n                    \"$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].email$\",\n                    \"$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_name$\",\n                    \"$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_city$, $activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_state$, $activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_country$\",\n                    \"$activity.definition_activity_01JZG3AEPJ7MQ3hxTm5EeMd2qKNAC7eqr7F.output.jsonpath_queries.auth_device_ip$\"                \n                ]\n                  ],\n            \"row_count\": 1\n            }\n    }",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $activity.definition_activity_01LW7XBX9TJE70eyZyhPZjz6QEGh8MzkYEv.output.variable_workflow_01KWJ2ISHZ9753Hoi7x9S5EPpucAbm53HHF$"
                        }
                      ],
                      "display_name": "Create Sigthings",
                      "method": "POST",
                      "relative_url": "/ctia/sighting",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Private_CTIA_Target"
                              }
                            ]
                          }
                        }
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01OLCLPLIEYN21ZuIMQNyG4CtPqIofrG9q3",
                    "name": "Condition Block",
                    "title": "fraud event ?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "fraud event ?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01OLCLQF5E7731YuLKsd7Pm4ccBM3PaaBAw",
                        "name": "Condition Branch",
                        "title": "yes",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].result$",
                            "operator": "eq",
                            "right_operand": "fraud"
                          },
                          "continue_on_failure": false,
                          "display_name": "yes",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01OLCBW3I7Z0L2zHY5UTqus7O8D0tmjBGpk",
                            "name": "Send Email",
                            "title": "Send Email to end user",
                            "type": "email.smtp_send_email",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "body": "\u003c!DOCTYPE html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n    \u003cmeta charset=\"UTF-8\"\u003e\n    \u003cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e\n    \u003ctitle\u003eCisco Secure Access - Fraud Auth request detected\u003c/title\u003e\n    \u003cstyle\u003e\n        html {\n            width: 100%;\n            height: 100%;\n            padding: 0px;\n            margin: 0px;\n        }\n        \n        body {\n            width: 100%;\n            height: 100%;\n            margin: 0;\n            display: grid;\n            grid-template-rows: min-content auto min-content;\n            grid-template-areas: \"header\"\n                                 \"main\"\n                                 \"footer\";\n        }\n\n        header, main, footer, div {\n            padding: 8px;\n        }\n\n        header {\n            grid-area: header;\n            color: white;\n        }\n\n        main {\n            grid-area: main\n        }\n\n        footer {\n            grid-area: footer;\n            background-color: #f2f2f2;\n        }\n\n        .container {\n            margin:0 auto;\n            max-width: 1200px;\n        }\n        \n        th, td {\n            padding: 16px;\n            text-align: left;\n            vertical-align: middle;\n            line-height: 24px;\n        }\n\n        .common {\n            color: #00bceb;\n        }\n\n        .suspicious {\n            color: #fbab18;\n        }\n\n        .malicious {\n            color: #e2231a;\n        }\n\n        small {\n            color: rgba(0,0,0,0.4)\n        }\n    \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n    \u003cheader style=\"padding: 4px; \"\u003e\n        \u003cdiv class=\"container\" style=\"background-color:#e2231a;\" style=\"color: white;\"\u003e\n            \u003ch2\u003eCisco Secure Access - Fraud Auth request detected\u003c/h2\u003e\n        \u003c/div\u003e\n    \u003c/header\u003e\n    \u003cmain\u003e\n  \u003cdiv class=\"container\"\u003e\n          \u003ctable style=\"border: 0;\n                          width: 100%;\n                          padding:8px;\n                          text-align: left;\n                          vertical-align: middle;\n                          line-height: 24px;\"\u003e\n               \u003cthead style=\"background-color: #f2f2f2;\"\u003e\n                    \u003cth\u003eRaison\u003c/th\u003e\n                \u003c/thead\u003e  \n              \u003ctr\u003e\n                    \u003ctd class=\"suspicious\"\u003eYour corporate credential maybe compromised.\u003c/td\u003e\n                \u003c/tr\u003e\n    \u003cdiv class=\"container\"\u003e\n            \u003ctable style=\"border: 0;\n                          width: 100%;\n                          padding:8px;\n                          text-align: left;\n                          vertical-align: middle;\n                          line-height: 24px;\"\u003e\n                \u003cthead style=\"background-color: #f2f2f2;\"\u003e\n                    \u003cth\u003eAction Required\u003c/th\u003e\n                \u003c/thead\u003e\n                \u003ctr\u003e\n                    \u003ctd class=\"malicious\"\u003ePlease change your corporate password as soon as possible.\u003c/td\u003e\n                \u003c/tr\u003e\n            \u003c/table\u003e\n        \u003c/div\u003e\n        \n    \u003c/main\u003e\n    \u003cfooter\u003e\n        \u003cdiv class=\"container\"\u003e\n            \u003csmall\u003eCisco Secure Access - SecureX Orchestration\u003c/small\u003e\n        \u003c/div\u003e\n    \u003c/footer\u003e\n\u003c/body\u003e\n\u003c/html\u003e",
                              "continue_if_one_address_valid": false,
                              "continue_on_failure": false,
                              "display_name": "Send Email to end user",
                              "html": true,
                              "runtime_user": {
                                "override_target_runtime_user": false,
                                "target_default": true
                              },
                              "skip_execution": false,
                              "subject": "[Alert] Authentification Request mark as Fraud",
                              "target": {
                                "override_workflow_target_group_criteria": true,
                                "target_group": {
                                  "run_on_all_targets": false,
                                  "use_criteria": {
                                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                                    "conditions": [
                                      {
                                        "left_operand": "$targetgroup.email smtp_endpoint.input.display_name$",
                                        "operator": "eq",
                                        "right_operand": "Email Endpoint"
                                      }
                                    ]
                                  }
                                }
                              },
                              "to": "$activity.definition_activity_01JZA41BSALUR4RG2rAk3ys680xN9YFjvXh.input.source_array[@].email$"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_01MKZNVM2JQFT3S81YP0BIjgPDDgOjCs3zL",
        "name": "Group",
        "title": "cleaning table",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "cleaning table",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01MKZMI8LPGVD3Arky3PSWLYSbsfLnjqg6D",
            "name": "Execute Python Script",
            "title": "Create ISO time",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Create ISO time",
              "script": "from datetime import datetime\nimport time\n\nlinux_time = int(time.time())-$workflow.definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3.local.variable_workflow_01JZJKVMAZYF24229wkg1zmzRqmTcXfmHRt$\n\nt =  int(linux_time)\ntimeISO = (datetime.fromtimestamp(t).isoformat())\nint_timeISO = int(t)",
              "script_queries": [
                {
                  "script_query": "int_timeISO",
                  "script_query_name": "int_timeISO",
                  "script_query_type": "integer"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MKZKIAOSJNM1aZzDX4Z0MQHBmW8yQGYR5",
            "name": "Select from Table",
            "title": "Select from Table",
            "type": "core.selectfromtable",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "columns": [
                {
                  "column_name": "txid",
                  "column_type": "string"
                },
                {
                  "column_name": "timestamp",
                  "column_type": "integer"
                }
              ],
              "continue_on_failure": false,
              "display_name": "Select from Table",
              "input_table": "$env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3.env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3$",
              "number_of_rows": {
                "all_rows": true,
                "at_most": false
              },
              "persist_output": false,
              "skip_execution": false,
              "sorting": {
                "no_sort": true,
                "sort_by": false
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01MKZNQPDTZJ82Rchou8uYlA3wJ6akvdXcZ",
            "name": "For Each",
            "title": "For Each",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For Each",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_01MKZKIAOSJNM1aZzDX4Z0MQHBmW8yQGYR5.output.output_table$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01ML045Y1T7114x7h529a9MEd77odnh88gP",
                "name": "Condition Block",
                "title": "need to be remove from table ?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "need to be remove from table ?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01ML046LALCFN5kRo9pk9XuTsPay6kLxvKv",
                    "name": "Condition Branch",
                    "title": "yes",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MKZNQPDTZJ82Rchou8uYlA3wJ6akvdXcZ.input.source_array[@].timestamp$",
                        "operator": "lt",
                        "right_operand": "$activity.definition_activity_01MKZMI8LPGVD3Arky3PSWLYSbsfLnjqg6D.output.script_queries.int_timeISO$"
                      },
                      "continue_on_failure": false,
                      "display_name": "yes",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MKZOJ3HL3E132FoI7NjcsoaagwbwP6QW5",
                        "name": "Delete from Table",
                        "title": "Delete from Table",
                        "type": "core.deleterowfromtable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Delete from Table",
                          "input_table": "$env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3.env.variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3$",
                          "rows": {
                            "rows_matching_criteria": true,
                            "where_clause": "timestamp == $activity.definition_activity_01MKZNQPDTZJ82Rchou8uYlA3wJ6akvdXcZ.input.source_array[@].timestamp$"
                          },
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01ML046LZ1VTO3SwenLwYNyE7eTf6OABDGn",
                    "name": "Condition Branch",
                    "title": "no",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01MKZNQPDTZJ82Rchou8uYlA3wJ6akvdXcZ.input.source_array[@].timestamp$",
                        "operator": "gt",
                        "right_operand": "$activity.definition_activity_01MKZMI8LPGVD3Arky3PSWLYSbsfLnjqg6D.output.script_queries.int_timeISO$"
                      },
                      "continue_on_failure": false,
                      "display_name": "no",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "triggers": {
    "triggerevent_01LWCQX6H8ZOQ0pwD2GRIKfWiuJwHz6Xqlc": {
      "workflow_id": "definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3",
      "name": "IMAP  Cisco Secure Access Alerts",
      "title": "",
      "lowercase_name": "event.imap__cisco_secure_access_alerts",
      "type": "event",
      "base_type": "trigger",
      "ref_id": "event_01LW9VTBYEDBS1ZTZJKYRXmidywcbiZMlH6",
      "version": "",
      "disabled": false,
      "unique_name": "triggerevent_01LWCQX6H8ZOQ0pwD2GRIKfWiuJwHz6Xqlc",
      "object_type": "triggerevent"
    },
    "triggerschedule_01MKZB1MEQTVC3ntWWD4MliIV4cbEx2i8Lm": {
      "workflow_id": "definition_workflow_01JYJXB8C0HR54RRyaIVedcUYV0huuTdfl3",
      "name": "Every hour",
      "title": "",
      "lowercase_name": "schedule.every_hour",
      "type": "schedule",
      "base_type": "trigger",
      "ref_id": "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ",
      "version": "1.0.0",
      "disabled": false,
      "unique_name": "triggerschedule_01MKZB1MEQTVC3ntWWD4MliIV4cbEx2i8Lm",
      "object_type": "triggerschedule"
    }
  },
  "events": {
    "event_01LW9VTBYEDBS1ZTZJKYRXmidywcbiZMlH6": {
      "name": "Cisco Secure Access - Fraudulent Auth Alerts",
      "title": "Cisco Secure Access - Fraudulent Auth Alerts",
      "type": "email.event",
      "base_type": "event",
      "object_type": "event",
      "target_id": "definition_target_01LW9UG1G9PGO4jt5SfmT1tvbVGi4f7OcF8",
      "webhook_id": "",
      "version": "1.0.0",
      "properties": {
        "action": "read",
        "conditions": {
          "left_operand": "$output.subject$",
          "operator": "eq",
          "right_operand": "Fraudulent authentication report"
        },
        "display_name": "events_securex@internetsinkhole.com",
        "download_attachments": true,
        "folder": "INBOX",
        "target_id": "definition_target_01LW9UG1G9PGO4jt5SfmT1tvbVGi4f7OcF8",
        "title": "Cisco Secure Access - Fraudulent Auth Alerts"
      },
      "unique_name": "event_01LW9VTBYEDBS1ZTZJKYRXmidywcbiZMlH6"
    }
  },
  "schedules": {
    "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ": {
      "unique_name": "schedule_01HW8M7A8CQK71LT9IHmr0kCTBJURhLdFDQ",
      "name": "EVERY HOUR",
      "type": "basic.schedule",
      "base_type": "schedule",
      "properties": {
        "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
        "timezone": "Etc/GMT+0",
        "starttime": "01:00",
        "interval_hours": 1,
        "interval_minutes": 0,
        "number_of_times": 23,
        "display_name": "EVERY HOUR",
        "description": ""
      },
      "version": "1.0.0",
      "object_type": "schedule"
    }
  },
  "targets": {
    "definition_target_01LW9UG1G9PGO4jt5SfmT1tvbVGi4f7OcF8": {
      "unique_name": "definition_target_01LW9UG1G9PGO4jt5SfmT1tvbVGi4f7OcF8",
      "name": "SecureX Trigger IMAP Mailbox",
      "title": "SecureX Trigger IMAP Mailbox",
      "type": "email.imap_endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01LW9U3WLTO8M2RaIoj66Eu0PnlxBskn9Ez",
        "display_name": "SecureX Trigger IMAP Mailbox",
        "ignore_certificate_errors": true,
        "polling_interval": 30,
        "port": 993,
        "protocol": "IMAP",
        "server": "outlook.office365.com",
        "tls_enabled": true
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01LW9U3WLTO8M2RaIoj66Eu0PnlxBskn9Ez": {
      "unique_name": "definition_runtime_user_01LW9U3WLTO8M2RaIoj66Eu0PnlxBskn9Ez",
      "name": "events_securex@internetsinkhole.com",
      "title": "events_securex@internetsinkhole.com",
      "type": "runtime_user.email_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "display_name": "events_securex@internetsinkhole.com",
        "password": "*****",
        "sender": "*****"
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "terminal.endpoint",
          "view_target_type": "terminal.endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "variables": {
    "variable_01J3NMTLR7YNW6Mhw1jTeohcSLMbVqTHWbQ": {
      "unique_name": "variable_01J3NMTLR7YNW6Mhw1jTeohcSLMbVqTHWbQ",
      "properties": {
        "value": "api-dd9523a4.duosecurity.com",
        "scope": "global",
        "name": "duo_host",
        "type": "datatype.string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01JBFLXC643HF1ugwbVoGAFGk9Co2XntKOE": {
      "unique_name": "variable_01JBFLXC643HF1ugwbVoGAFGk9Co2XntKOE",
      "properties": {
        "value": "DI1VENY8MGIG2A4C0S8X",
        "scope": "global",
        "name": "duo_admin_ikey",
        "type": "datatype.string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01JBFMBVN62Y67X2aODY3UyX2L0ZC1inw0Y": {
      "unique_name": "variable_01JBFMBVN62Y67X2aODY3UyX2L0ZC1inw0Y",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "duo_admin_skey",
        "type": "datatype.secure_string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3": {
      "unique_name": "variable_01ML0DB55YHLL2JOBn1pyeggcLHHgTtssM3",
      "schema_id": "tabletype_01ML0C4Q6DA116Sqz5qlLviuvMJG8foZP0y",
      "properties": {
        "scope": "env",
        "name": "Cisco Secure Access - Denied and Fraud",
        "type": "datatype.table",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01ML0C4Q6DA116Sqz5qlLviuvMJG8foZP0y": {
      "unique_name": "tabletype_01ML0C4Q6DA116Sqz5qlLviuvMJG8foZP0y",
      "data_type": "datatype.tabletype",
      "display_name": "Cisco Secure Access - Denied and Fraud",
      "columns": [
        {
          "name": "result",
          "title": "result",
          "type": "string"
        },
        {
          "name": "timestamp",
          "title": "timestamp",
          "type": "integer"
        },
        {
          "name": "txid",
          "title": "txid",
          "type": "string"
        },
        {
          "name": "user",
          "title": "user",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "atomic_workflows": [
    "definition_workflow_01KWJ2ISZTF2V6ibRYe7FZ7sOuycDOpnwss",
    "definition_workflow_01JYONCDVQVZ62K7SkNWdQCuAPUgfdRcFAF",
    "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
  ]
}